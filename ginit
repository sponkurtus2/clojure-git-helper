#!/usr/bin/env bb

(require '[clojure.java.shell :as sh])

(def add ["add" "."])
(defn commit [commit-msg] ["commit" "-m" commit-msg])
(def push ["push"])

(defn execute-process [commit-msg]
  (let [commands [add (commit commit-msg) push]]
    (doseq [args commands]
      (let [result (apply sh/sh "git" args)]
        (println (:out result))
        (println (:err result))))))

(let [args *command-line-args*]
  (if (empty? args)
    (println "Error: Falta mensaje")
    (execute-process (first args))))
